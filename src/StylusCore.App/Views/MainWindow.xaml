<Window x:Class="StylusCore.App.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:controls="clr-namespace:StylusCore.App.Shared.Components"
        xmlns:views="clr-namespace:StylusCore.App.Features.Library.Views"
        xmlns:converters="clr-namespace:StylusCore.App.Shared.Converters"
        Title="StylusCore"
        Width="1280" Height="800"
        MinWidth="800" MinHeight="600"
        WindowStartupLocation="CenterScreen"
        Background="{DynamicResource PrimaryBackgroundBrush}"
        WindowStyle="None"
        AllowsTransparency="False"
        ResizeMode="CanResize"
        MouseDown="Window_MouseDown"
        StateChanged="Window_StateChanged">

    <WindowChrome.WindowChrome>
        <WindowChrome CaptionHeight="32"  
                      ResizeBorderThickness="5"
                      GlassFrameThickness="0"
                      CornerRadius="0"
                      UseAeroCaptionButtons="False"/>
    </WindowChrome.WindowChrome>

    <!-- Main Window Border (Rounded Corners) -->
    <Border Background="{DynamicResource PrimaryBackgroundBrush}"
            CornerRadius="12"
            BorderBrush="{DynamicResource PrimaryBorderBrush}"
            BorderThickness="1">

            <!-- GLOBAL GRID STRUCTURE (Clean Shell) -->
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/> <!-- Row 0: Header -->
                    <RowDefinition Height="Auto"/> <!-- Row 1: Ribbon (Editor Only) -->
                    <RowDefinition Height="*"/>    <!-- Row 2: Body (Sidebar + Content) -->
                </Grid.RowDefinitions>
    
                <!-- ROW 0: GLOBAL HEADER -->
                <controls:HeaderControl Grid.Row="0" Panel.ZIndex="1000"/>

                <!-- ROW 1: RIBBON (Visible only in Editor Mode) -->
                <Border Grid.Row="1"
                        Background="{DynamicResource TertiaryBackgroundBrush}"
                        BorderBrush="{DynamicResource PrimaryBorderBrush}"
                        BorderThickness="0,0,0,1"
                        Padding="8,4"
                        Visibility="{Binding IsRibbonVisible, Converter={StaticResource BoolToVisibilityConverter}}">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <!-- Ribbon Content -->
                        <StackPanel Grid.Column="0" Orientation="Horizontal"
                                    Visibility="{Binding IsRibbonFull, Converter={StaticResource BoolToVisibilityConverter}}">
                            <!-- Group: Selection -->
                            <StackPanel Orientation="Horizontal" Margin="0,0,16,0">
                                <!-- Select Tool -->
                                <Button ToolTip="{DynamicResource Str_Tooltip_Select}" Style="{DynamicResource IconButtonStyle}" 
                                        Width="{DynamicResource Height_Button_Standard}" Height="{DynamicResource Height_Button_Standard}" 
                                        Command="{Binding SelectToolCommand}">
                                    <Path Data="{StaticResource Icon.Select}" Style="{StaticResource IconBase}"/>
                                </Button>
                                <!-- Lasso Select -->
                                <Button ToolTip="{DynamicResource Str_Tooltip_Lasso}" Style="{DynamicResource IconButtonStyle}" 
                                        Width="{DynamicResource Height_Button_Standard}" Height="{DynamicResource Height_Button_Standard}" 
                                        Margin="{DynamicResource Margin_Small}">
                                    <Path Data="{StaticResource Icon.Lasso}" Style="{StaticResource IconBase}"/>
                                </Button>
                            </StackPanel>

                            <!-- Divider -->
                            <Rectangle Width="1" Fill="{DynamicResource PrimaryBorderBrush}" Margin="8,8,16,8"/>

                            <!-- Group: Tools -->
                            <StackPanel Orientation="Horizontal">
                                <!-- Pen -->
                                <Button Width="40" Height="40" Margin="{DynamicResource Margin_Small}" Style="{DynamicResource IconButtonStyle}" ToolTip="{DynamicResource Str_Tooltip_PenBlack}">
                                    <Grid>
                                        <Path Data="{StaticResource Icon.Pen}" Style="{StaticResource IconBase}"/>
                                        <!-- Color Indicator (TODO: Make Dynamic) -->
                                        <Ellipse Width="8" Height="8" Fill="{DynamicResource PrimaryTextBrush}" VerticalAlignment="Bottom" HorizontalAlignment="Right" Margin="0,0,-2,-2"/>
                                    </Grid>
                                </Button>
                                <!-- Pen (Red) -->
                                <Button Width="40" Height="40" Margin="{DynamicResource Margin_Small}" Style="{DynamicResource IconButtonStyle}" ToolTip="{DynamicResource Str_Tooltip_PenRed}">
                                    <Grid>
                                        <Path Data="{StaticResource Icon.Pen}" Style="{StaticResource IconBase}" Stroke="{DynamicResource AccentBrush}"/>
                                        <Ellipse Width="8" Height="8" Fill="{DynamicResource AccentBrush}" VerticalAlignment="Bottom" HorizontalAlignment="Right" Margin="0,0,-2,-2"/>
                                    </Grid>
                                </Button>
                                <!-- Highlighter -->
                                <Button Width="40" Height="40" Margin="{DynamicResource Margin_Small}" Style="{DynamicResource IconButtonStyle}" ToolTip="{DynamicResource Str_Tooltip_Highlighter}">
                                    <Path Data="{StaticResource Icon.Highlighter}" Style="{StaticResource IconBase}" Stroke="{DynamicResource HighlightBrush}" Fill="{DynamicResource HighlightFillBrush}"/>
                                </Button>
                                <!-- Eraser -->
                                <Button Width="40" Height="40" Margin="{DynamicResource Margin_Small}" Style="{DynamicResource IconButtonStyle}" ToolTip="{DynamicResource Str_Tooltip_Eraser}">
                                    <Path Data="{StaticResource Icon.Eraser}" Style="{StaticResource IconBase}"/>
                                </Button>
                            </StackPanel>

                            <!-- Divider -->
                            <Rectangle Width="1" Fill="{DynamicResource PrimaryBorderBrush}" Margin="16,8,16,8"/>

                            <!-- Group: Shapes -->
                            <StackPanel Orientation="Horizontal">
                                <!-- Rect -->
                                <Button Width="{DynamicResource Height_Button_Standard}" Height="{DynamicResource Height_Button_Standard}" 
                                        Margin="{DynamicResource Margin_Small}" Style="{DynamicResource IconButtonStyle}" ToolTip="{DynamicResource Str_Tooltip_Rect}">
                                    <Path Data="{StaticResource Icon.Rectangle}" Style="{StaticResource IconBase}"/>
                                </Button>
                            </StackPanel>

                            <!-- Group: Ink to Shape -->
                            <Button Width="{DynamicResource Height_Button_Standard}" Height="{DynamicResource Height_Button_Standard}" 
                                    Margin="{DynamicResource Margin_Small}" Style="{DynamicResource IconButtonStyle}" ToolTip="{DynamicResource Str_Tooltip_InkToShape}">
                                <Path Data="{StaticResource Icon.InkToShape}" Style="{StaticResource IconBase}"/>
                            </Button>
                        </StackPanel>

                        <!-- Ribbon Display Options (Right Aligned) -->
                        <Button Grid.Column="1" 
                                ToolTip="{DynamicResource Str_Tooltip_CycleRibbonMode}" 
                                Style="{DynamicResource IconButtonStyle}"
                                Width="{DynamicResource Height_Button_Standard}" 
                                Height="{DynamicResource Height_Button_Standard}"
                                Command="{Binding CycleRibbonModeCommand}"
                                Margin="0,0,8,0">
                            <Path Data="{StaticResource Icon.ChevronDown}" Style="{StaticResource IconBase}"/>
                        </Button>
                    </Grid>
                </Border>
    
                <!-- ROW 2: MAIN BODY (Sidebar + Content) -->
                <Grid Grid.Row="2">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition x:Name="SidebarColumn" Width="48"/> <!-- Sabit, code-behind'dan gÃ¼ncellenir -->
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
    
                    <!-- SIDEBAR -->
                    <controls:Sidebar x:Name="Sidebar" Grid.Column="0" Loaded="Sidebar_Loaded"/>
    
                    <!-- MAIN CONTENT -->
                    <Border Grid.Column="1" Background="{DynamicResource SecondaryBackgroundBrush}">
                        <Frame x:Name="MainContentFrame" NavigationUIVisibility="Hidden"/>
                    </Border>
                </Grid>
            </Grid>
    </Border>

</Window>
